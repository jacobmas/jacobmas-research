\newif\iflncs\lncstrue
\documentclass[oribibl,envcountsect,envcountsame]{llncs}
%\usepackage{times}        // Not Allowed for TCC ---Daniel
%\usepackage{fullpage}    // Not Allowed for TCC submission ---Daniel
\usepackage{microtype}
\usepackage{amsmath,amsfonts,amssymb}
%\usepackage{hyperref}
% mathabx overrides many math fonts with ugly ones; instead, add
% individual commands in head.tex (see declaration of \boxplus etc.)
%\usepackage{mathabx}
%\usepackage[amsmath,amsthm,thmmarks,hyperref]{ntheorem}

\usepackage{float}
\usepackage{mathtools}
\usepackage{url}
\usepackage{xspace}
\usepackage{enumitem}

% show equation numbers only for referenced equations
%\mathtoolsset{showonlyrefs}

\newif\iffull\fulltrue


\input{head}
%\input{paperhead}


\newcommand{\Lat}{\Lambda}

\newcommand{\setbad}{\textsf{BAD}}
\newcommand{\setguesses}{\textsf{GUESSES}}
\newcommand{\GRS}{\textsf{GRS}}
\newcommand{\GF}{\text{GF}}

\usepackage{xcolor}
\newcommand{\daniel}[1]{Daniel: #1}
\newcommand{\todo}[1]{TO-DO: #1}

\pagestyle{plain}


%%%%

\title{Thoughts on RLCE}

\author{%
  Jacob Alperin-Sheriff
}
\institute{NIST
  \email{jacob.alperin-sheriff@nist.gov}
}

\begin{document}
 % \floatstyle{boxed}
 % \restylefloat{figure}

\maketitle
\thispagestyle{plain}
%\begin{abstract}
%  
%  
%\input{abstract}


%\end{abstract}

% \paragraph{Keywords.} fully homomorphic encryption, bootstrapping,
% lattice-based cryptography

%\clearpage
%\pagenumbering{arabic} 
\section{Basic Facts}

Let $\bar{\matG}=[\vecg_0, \ldots, \vecg_{n-1}] \in \GF(q)^{k \times n}$ be a
generator matrix for some Generalized-Reed Solomon $\GRS_{n,k}(\vecalpha,\vecv)$ in the public
key. This is denoted as $\matG_{s}\matP_{1}$ in the
definition of RLCE in the specification.

Let $\vecr_0, \ldots, \vecr_{w-1} \in \GF(q)^{k}$ be the column vectors
chosen uniformly at random, and let 
\[\matG_{1}= [\vecg_0, \ldots, \vecg_{n-w-1}, \vecg_{n-w},
\vecr_0, \ldots, \vecg_{n-1}, \vecr_{w-1}]\]

For $i \in [0,\ldots,w-1]$, let $\matA_{i}
= \begin{bmatrix}a_{i,00}&a_{i,01}\\a_{i,10}&a_{i,11}\end{bmatrix} \in
\GF(q)^{2 \times 2}$ be non-singular matrices chosen uniformly at
random such that 
$a_{i,00}a_{i,01}a_{i,10}a_{i,11}\neq 0$ for all $i$, let 

\[\matA=\text{diag}[\matI_{n-w}, \matA_{0}, \ldots, \matA_{w-1}] \in
  \GF(q)^{(n + w) \times (n+w)}\]

Finally, let $\matS \in \GF(q)^{k \times k}$ be chosen uniformly at
random, and let $\matP \in \GF(q)^{(n+w)\times (n+w)}$ be a
permutation matrix. 

Then the public key given in RLCE is $\matG=\matS\matG_1\matA\matP$. 


\section{Dual Code of Public Key}
\label{sec:dual-code}

Here we describe the (exploitable) structure of the dual code. 

First, the dual code of the GRS code $\GRS_{n,k}(\vecalpha,\vecv)$ generated by
$\bar{\matG}$ is 

\[\GRS_{n,n-k}(\vecalpha,\vecu),\quad u_i^{-1} v_i \sum_{j \neq
    i}(\alpha_{i}-\alpha_{j})\]

Let $\bar{\matH}=[\vech_0, \ldots, \vech_{n-1}] \in \Z_q^{(n-k) \times
  n}$ be the canonical matrix generating this dual code, meaning that 

\[\vech_{j}^t=[u_j, u_j\alpha_j, u_j\alpha_j^2, \ldots, u_j\alpha_j^{n-k-1}]\]

Let \[\matH_{1} = [\vech_0, \ldots, \vech_{n-w-1}, \vech_{n-w},
\veczero,\vech_{n-w+1},\veczero,\ldots,\vech_{n-1},\veczero\]

Note that $\matP^{t}=\matP^{-1}$ for any permutation matrix $\matP$.


Let

$\matH=\matH_{1}\matA^{-t}\matP$, 

we have that 

\[\matH=\tilde{\matH}\matP,\]

where, letting $\matB_i=\matA_{i}^{-1}$, we have that 
\[\tilde{\matH}=[\vech_0, \ldots, \vech_{n-w-1}, b_{0,00}\vech_{n-w},
  b_{0,01}\vech_{n-w},
  \ldots, b_{w-1,00}\vech_{n-1}, b_{w-1,01}\vech_{n-1}]\]

Furthermore, we have that

\begin{align*}\matG\matH^{t}&=\matS\matG_{1}\matA\matP\matP^{t}\matA^{-1}\matH_{1}^{t}\\
&=\matS\matG_{1}\matH_{1}^{t}\\
&=\matzero\\
\end{align*}

so that the dual code of the linear code generated by the public key
$\matG$ has the highly structured $\matH$ as a subcode. 

\section{The Attack}
\label{sec:attack}


So, given the public key $\matG \in \GF(q)^{k \times (n+w)}$, we first
compute (via linear algebra) some matrix $\matG^{\perp} \in
\GF(q)^{(n-k+w)\times (n+w)}$ generating the dual code to $\matG$.

Our goal is to find some $\matS \in \GF(q)^{(n-k)\times (n-k+w)}$ such
that 
$\matS\matG^{\perp}$ generates the same highly structured subcode as
$\matH$ above, i.e. such that for some non-singular matrix $\matT \in
\GF(q)^{w \times w}$, 

\[\matS\matG^{\perp}=\matT\matH\]

 

\subsection{Sidelnikov-Shestakov}
\label{sec:sidelnikov-shestakov}


In particular, we can use a algebraic attack-based extension of the
Sidelnikov-Shestakov technique~\cite{sidelnikovshestakov} to recover enough secret information to
completely break the scheme. 

The key observation enabling the Sidelnikov-Shestakov attack is that,
when a $\text{GRS}_{n,k}$ code is in systematic form $[\matI \mid
\hat{\matG}]$, the degree $k-1$ polynomial $f_{i}$ being evaluated at 
$\alpha_{j}$ (corresponding to the values in the $i$th row of the matrix) will have roots at $\{\alpha_{t}, 0 \leq t < k,\quad
j\neq k\}$. As a result, for any distinct pair of rows $i_1, i_2$,
the degree of $\text{gcd}(f_{i_1}, f_{i_2})$ will be $k-2$.

Unfortunately, thanks to the repeated (up to a linear multiple) columns,  we cannot in fact
assume that $\matT\matH$ has a leftmost $\matI$ as in the
Sidelnikov-Shestakov attack, as this is in fact very unlikely to be
the case. 

However, we \emph{can} assume that the first row is $\vece_1$ and that
the leftmost $n-k \times n-k$ submatrix of $\matT\matH$ is upper
triangular. 

\jnote{TODO: prove}

 








\bibliographystyle{alpha}
\bibliography{lattices,crypto,ibe,fhe,numtheory,coding}

\end{document}


%%% Local Variables:
%%% mode: latex
%%% TeX-master: t
%%% End:
